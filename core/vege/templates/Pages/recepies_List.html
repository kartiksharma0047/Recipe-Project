{% extends "base.html" %} {% block start %}
<div
  class="container min-vh-100 d-flex align-items-center justify-content-center"
>
  <div class="row w-100">
    <!-- Left Side Button -->
    <div
      class="col-12 col-md-2 mb-3 d-flex align-items-center justify-content-center"
    >
      <a href="/" class="btn btn-outline-light">Add Recipe</a>
    </div>

    <!-- Centered Scrollable Table -->
    <div class="col-12 col-md-10">
      <div
        class="table-responsive"
        style="
          max-height: 500px;
          overflow-y: auto;
          background-color: rgba(255, 255, 255, 0.05);
          padding: 1rem;
          border-radius: 1rem;
        "
      >
        <h2 class="text-center mb-4">List of Recipes</h2>
        <table
          class="table table-hover table-bordered table-dark align-middle text-center"
        >
          <thead class="table-light text-dark">
            <tr>
              <th>S No.</th>
              <th>Recipe Name</th>
              <th>Recipe Description</th>
              <th>Recipe Image</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for recepie in context %}
            <tr>
              <td>{{ forloop.counter }}</td>
              <td>{{ recepie.receipe_name }}</td>
              <td>
                <span class="short-desc"
                  >{{ recepie.receipe_description|truncatechars:50 }}</span
                >
                <span class="full-desc d-none"
                  >{{ recepie.receipe_description }}</span
                >
                <br />
                <button
                  class="btn btn-sm btn-link text-light toggle-desc-btn p-0"
                >
                  Show more
                </button>
              </td>
              <td>
                <img
                  src="{{ recepie.receipe_image.url }}"
                  alt="recepie.receipe_image"
                  width="100"
                  height="80"
                  style="object-fit: cover; border-radius: 6px"
                />
              </td>
              <td>
                <a href="delete-receipe/{{recepie.id}}/" class="btn btn-danger">Delete</a>
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="4">No recipes found.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- JavaScript for Show More / Less toggle -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const toggleButtons = document.querySelectorAll(".toggle-desc-btn");

    toggleButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        const td = btn.closest("td");
        const shortDesc = td.querySelector(".short-desc");
        const fullDesc = td.querySelector(".full-desc");

        const isExpanded = !fullDesc.classList.contains("d-none");

        if (isExpanded) {
          fullDesc.classList.add("d-none");
          shortDesc.classList.remove("d-none");
          btn.textContent = "Show more";
        } else {
          fullDesc.classList.remove("d-none");
          shortDesc.classList.add("d-none");
          btn.textContent = "Show less";
        }
      });
    });
  });
</script>
{% endblock %}
